<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Filtre de Bloom - Pr√©sentation Interactive</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    
    <!-- MathJax pour le rendu LaTeX -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            }
        };
    </script>
    
    <!-- Chart.js pour les graphiques -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <div class="presentation-container">
        <!-- Slide 1: Introduction -->
        <div class="slide active" id="slide1">
            <h1 class="slide-title">Filtre de Bloom</h1>
            <h2 class="slide-subtitle">Structure de donn√©es probabiliste</h2>
            
            <div class="slide1-layout">
                <!-- Colonne gauche : Histoire + Sch√©ma -->
                <div class="left-column">
                    <div class="history-banner">
                        <div class="history-content">
                            <div class="history-icon">üë®‚Äçüî¨</div>
                            <div class="history-text">
                                <h3>üìú Histoire</h3>
                                <p><strong>Burton Howard Bloom</strong> (1970) - Informaticien am√©ricain</p>
                                <p>Cr√©√© pour r√©soudre un probl√®me de <strong>limitation de m√©moire</strong> dans les syst√®mes de v√©rification orthographique. 
                                √Ä l'√©poque, stocker des dictionnaires entiers en m√©moire √©tait co√ªteux. Bloom a eu l'id√©e r√©volutionnaire d'utiliser 
                                des <strong>fonctions de hachage multiples</strong> et un <strong>tableau de bits</strong> pour cr√©er une repr√©sentation 
                                compacte acceptant un petit taux d'erreur contr√¥l√©.</p>
                                <p class="history-quote">üí° <em>"Accepter quelques faux positifs pour gagner 10x-100x en m√©moire"</em></p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="visual-diagram">
                        <div class="bloom-schema">
                            <div class="element">√âl√©ment</div>
                            <div class="arrow">‚Üí</div>
                            <div class="hash-functions">
                                <div class="hash">h‚ÇÅ</div>
                                <div class="hash">h‚ÇÇ</div>
                                <div class="hash">h‚ÇÉ</div>
                            </div>
                            <div class="arrow">‚Üí</div>
                            <div class="bitarray">
                                <span class="bit">0</span>
                                <span class="bit active">1</span>
                                <span class="bit">0</span>
                                <span class="bit active">1</span>
                                <span class="bit">0</span>
                                <span class="bit active">1</span>
                                <span class="bit">0</span>
                                <span class="bit">0</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Colonne droite : Infos en grille compacte -->
                <div class="right-column">
                    <div class="info-box">
                        <h3>üìå Objectif</h3>
                        <p>Tester rapidement l'appartenance d'un √©l√©ment √† un ensemble avec une empreinte m√©moire minimale</p>
                    </div>
                    
                    <div class="info-box">
                        <h3>‚úÖ Avantages</h3>
                        <ul>
                            <li>Tr√®s √©conome en m√©moire</li>
                            <li>Temps de recherche constant O(k)</li>
                            <li>Aucun faux n√©gatif</li>
                        </ul>
                    </div>
                    
                    <div class="info-box">
                        <h3>‚ö†Ô∏è Inconv√©nient</h3>
                        <ul>
                            <li>Faux positifs possibles</li>
                            <li>Pas de suppression (standard)</li>
                        </ul>
                    </div>
                    
                    <div class="info-box">
                        <h3>üéØ Applications</h3>
                        <ul>
                            <li>Cache web (√©viter requ√™tes inutiles)</li>
                            <li>V√©rification de mots de passe compromis</li>
                            <li>Bases de donn√©es distribu√©es</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 2: Fonctionnement -->
        <div class="slide" id="slide2">
            <h1 class="slide-title">Fonctionnement</h1>
            <h2 class="slide-subtitle">Ajout et recherche d'√©l√©ments</h2>
            
            <div class="slide2-layout">
                <!-- Partie gauche : Param√®tres + Exemple -->
                <div class="slide2-left">
                    <!-- Param√®tres d'entr√©e -->
                    <div class="params-banner">
                        <h3>üéõÔ∏è Param√®tres d'entr√©e</h3>
                        <div class="params-grid">
                            <div class="param-item">
                                <span class="param-name">n</span>
                                <span class="param-desc">Capacit√©</span>
                            </div>
                            <div class="param-arrow">‚Üí</div>
                            <div class="param-item">
                                <span class="param-name">p</span>
                                <span class="param-desc">Taux erreur</span>
                            </div>
                            <div class="param-arrow">‚áí</div>
                            <div class="param-result">
                                <div class="param-output">
                                    <span class="param-name">m</span>
                                    <span class="param-desc">Taille bits</span>
                                </div>
                                <div class="param-output">
                                    <span class="param-name">k</span>
                                    <span class="param-desc">Nb hash</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Exemple concret -->
                    <div class="concrete-example">
                        <h3>üìù Exemple : "chat", "chien", "oiseau"</h3>
                        <p class="example-params">n=10, p=0.1 ‚Üí <strong>m=16, k=3</strong></p>
                        
                        <div class="unified-example">
                            <!-- Tableau de hachages -->
                            <div class="hash-table">
                                <div class="hash-row">
                                    <span class="word-label chat">üê± chat</span>
                                    <div class="hash-values">
                                        <span class="hash-badge chat">h‚ÇÅ=2</span>
                                        <span class="hash-badge chat">h‚ÇÇ=7</span>
                                        <span class="hash-badge chat">h‚ÇÉ=11</span>
                                    </div>
                                </div>
                                <div class="hash-row">
                                    <span class="word-label chien">üêï chien</span>
                                    <div class="hash-values">
                                        <span class="hash-badge chien">h‚ÇÅ=7</span>
                                        <span class="hash-badge chien">h‚ÇÇ=14</span>
                                        <span class="hash-badge chien">h‚ÇÉ=5</span>
                                    </div>
                                </div>
                                <div class="hash-row">
                                    <span class="word-label oiseau">üê¶ oiseau</span>
                                    <div class="hash-values">
                                        <span class="hash-badge oiseau">h‚ÇÅ=11</span>
                                        <span class="hash-badge oiseau">h‚ÇÇ=9</span>
                                        <span class="hash-badge oiseau">h‚ÇÉ=0</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Tableau de bits unique -->
                            <div class="unified-bitarray">
                                <div class="bitarray-indices">
                                    <span class="idx">0</span>
                                    <span class="idx">1</span>
                                    <span class="idx">2</span>
                                    <span class="idx">3</span>
                                    <span class="idx">4</span>
                                    <span class="idx">5</span>
                                    <span class="idx">6</span>
                                    <span class="idx">7</span>
                                    <span class="idx">8</span>
                                    <span class="idx">9</span>
                                    <span class="idx">10</span>
                                    <span class="idx">11</span>
                                    <span class="idx">12</span>
                                    <span class="idx">13</span>
                                    <span class="idx">14</span>
                                    <span class="idx">15</span>
                                </div>
                                <div class="bitarray-values">
                                    <span class="bit active oiseau" title="oiseau">1</span>
                                    <span class="bit">0</span>
                                    <span class="bit active chat" title="chat">1</span>
                                    <span class="bit">0</span>
                                    <span class="bit">0</span>
                                    <span class="bit active chien" title="chien">1</span>
                                    <span class="bit">0</span>
                                    <span class="bit active collision" title="chat + chien">1</span>
                                    <span class="bit">0</span>
                                    <span class="bit active oiseau" title="oiseau">1</span>
                                    <span class="bit">0</span>
                                    <span class="bit active collision" title="chat + oiseau">1</span>
                                    <span class="bit">0</span>
                                    <span class="bit">0</span>
                                    <span class="bit active chien" title="chien">1</span>
                                    <span class="bit">0</span>
                                </div>
                                <div class="bitarray-legend">
                                    <span class="legend-item"><span class="color-box chat"></span> Chat</span>
                                    <span class="legend-item"><span class="color-box chien"></span> Chien</span>
                                    <span class="legend-item"><span class="color-box oiseau"></span> Oiseau</span>
                                    <span class="legend-item"><span class="color-box collision"></span> Collision</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Partie droite : 3 cas de test en vertical -->
                <div class="slide2-right">
                    <h3 class="test-title">üß™ 3 Cas de Test</h3>
                    
                    <!-- Cas 1 : Trouv√© -->
                    <div class="test-case success">
                        <div class="case-header">
                            <span class="case-icon">‚úÖ</span>
                            <span class="case-title">Test: "chat"</span>
                        </div>
                        <div class="case-body">
                            <p class="case-check">h‚ÇÅ=2, h‚ÇÇ=7, h‚ÇÉ=11</p>
                            <div class="case-bits">
                                <span class="check-bit ok">bit[2]=1 ‚úì</span>
                                <span class="check-bit ok">bit[7]=1 ‚úì</span>
                                <span class="check-bit ok">bit[11]=1 ‚úì</span>
                            </div>
                            <p class="case-result success-result"><strong>Probablement pr√©sent</strong> ‚úÖ</p>
                        </div>
                    </div>
                    
                    <!-- Cas 2 : Non trouv√© -->
                    <div class="test-case absent">
                        <div class="case-header">
                            <span class="case-icon">‚ùå</span>
                            <span class="case-title">Test: "lapin"</span>
                        </div>
                        <div class="case-body">
                            <p class="case-check">h‚ÇÅ=3, h‚ÇÇ=8, h‚ÇÉ=13</p>
                            <div class="case-bits">
                                <span class="check-bit fail">bit[3]=0 ‚úó</span>
                                <span class="check-bit">bit[8]=0</span>
                                <span class="check-bit">bit[13]=1</span>
                            </div>
                            <p class="case-result absent-result"><strong>Obligatoirement absent</strong> ‚ùå</p>
                        </div>
                    </div>
                    
                    <!-- Cas 3 : Faux positif -->
                    <div class="test-case false-positive">
                        <div class="case-header">
                            <span class="case-icon">‚ö†Ô∏è</span>
                            <span class="case-title">Test: "renard"</span>
                        </div>
                        <div class="case-body">
                            <p class="case-check">h‚ÇÅ=0, h‚ÇÇ=7, h‚ÇÉ=14</p>
                            <div class="case-bits">
                                <span class="check-bit ok">bit[2]=1 ‚úì</span>
                                <span class="check-bit ok">bit[0]=1 ‚úì</span>
                                <span class="check-bit ok">bit[14]=1 ‚úì</span>
                            </div>
                            <p class="case-result fp-result"><strong>FAUX POSITIF</strong> ‚ö†Ô∏è<br>
                            <small>(jamais ajout√© mais bits √† 1 par collision)</small></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 3: Formules et Probabilit√©s -->
        <div class="slide" id="slide3">
            <h1 class="slide-title">Formules et Probabilit√©s</h1>
            
            <div class="slide3-layout">
                <!-- Colonne gauche : D√©monstration -->
                <div class="slide3-left">
                    <div class="demonstration-section">
                        <h3>üî¨ D√©monstration : Probabilit√© de faux positif</h3>
                        
                        <!-- Bloc 1 : Deux parties -->
                        <div class="demo-step-double">
                            <div class="demo-half">
                                <p class="step-label">1Ô∏è‚É£ a) Proba de toucher un bit :</p>
                                <p class="formula">$$P(\text{toucher bit i}) = \frac{1}{m}$$</p>
                            </div>
                            <div class="demo-half">
                                <p class="step-label">1Ô∏è‚É£ b) Proba de NE PAS le toucher :</p>
                                <p class="formula">$$P(\text{bit = 0}) = 1 - \frac{1}{m}$$</p>
                            </div>
                        </div>
                        
                        <div class="demo-step">
                            <p class="step-label">2Ô∏è‚É£ Apr√®s insertion de <em>n</em> √©l√©ments avec <em>k</em> fonctions de hachage :</p>
                            <p class="formula">$$P(\text{bit = 0}) = \left(1 - \frac{1}{m}\right)^{kn}$$</p>
                        </div>
                        
                        <div class="demo-step">
                            <p class="step-label">3Ô∏è‚É£ Probabilit√© qu'un bit soit √† 1 :</p>
                            <p class="formula">$$P(\text{bit = 1}) = 1 - \left(1 - \frac{1}{m}\right)^{kn}$$</p>
                        </div>
                        
                        <div class="demo-step highlight">
                            <p class="step-label">4Ô∏è‚É£ Faux positif = tous les k bits test√©s sont √† 1 :</p>
                            <p class="formula">$$P_{fp} = \left[1 - \left(1 - \frac{1}{m}\right)^{kn}\right]^k$$</p>
                        </div>
                        
                        <!-- Approximation sur la m√™me ligne (2 blocs c√¥te √† c√¥te) -->
                        <div class="demo-step-double">
                            <div class="demo-half">
                                <p class="step-label">5Ô∏è‚É£ Quand m est grand :</p>
                                <p class="formula">$$\lim_{m \to \infty} \left(1 - \frac{1}{m}\right)^{kn} = e^{-\frac{kn}{m}}$$</p>
                            </div>
                            <div class="demo-half">
                                <p class="step-label">6Ô∏è‚É£ Approximation finale :</p>
                                <p class="formula">$$P_{fp} \approx \left(1 - e^{-\frac{kn}{m}}\right)^k$$</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Colonne droite : Calculateur interactif -->
                <div class="slide3-right">
                    <!-- Bloc horizontal : Param√®tres optimaux + Garantie -->
                    <div class="top-info-double">
                        <!-- Param√®tres optimaux -->
                        <div class="optimal-params-box">
                            <h3>üéØ Param√®tres Optimaux</h3>
                            <p class="optimal-explanation">
                                Par analyse de <strong>convexit√©</strong>, on minimise $P_{fp}$ :
                            </p>
                            <div class="optimal-formulas">
                                <div class="formula-optimal">
                                    <span class="formula-label">Taille optimale :</span>
                                    <span class="formula-math">$m = \frac{-n \ln(p)}{(\ln 2)^2}$</span>
                                </div>
                                <div class="formula-optimal">
                                    <span class="formula-label">Nombre optimal :</span>
                                    <span class="formula-math">$k = \frac{m}{n} \ln(2)$</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Garantie : Pas de faux n√©gatifs -->
                        <div class="no-false-negative-box">
                            <h3>‚úÖ Garantie Math√©matique</h3>
                            <p class="guarantee-text">
                                <strong class="highlight-guarantee">Aucun faux n√©gatif !</strong>
                            </p>
                            <p class="guarantee-explanation">
                                Si √©l√©ment ajout√© ‚Üí k bits √† 1<br>
                                <span class="math-highlight">$P(\text{faux n√©gatif}) = 0$</span>
                            </p>
                        </div>
                    </div>
                    
                    <div class="interactive-calculator">
                        <h3>üéõÔ∏è Calculateur interactif</h3>
                        
                        <div class="slider-group">
                            <label>
                                Nombre d'√©l√©ments (n): <span id="n-value">1000</span>
                            </label>
                            <input type="range" id="n-slider" min="100" max="1000000" step="100" value="1000">
                        </div>
                        
                        <div class="slider-group">
                            <label>
                                Taux d'erreur (p): <span id="p-value">0.01</span>
                            </label>
                            <input type="range" id="p-slider" min="0.001" max="1" step="0.001" value="0.01">
                        </div>
                        
                        <div class="results-grid">
                            <div class="result-box">
                                <div class="result-label">Taille (m)</div>
                                <div class="result-value" id="result-m">-</div>
                                <div class="result-unit">bits</div>
                            </div>
                            <div class="result-box">
                                <div class="result-label">Fonctions (k)</div>
                                <div class="result-value" id="result-k">-</div>
                            </div>
                            <div class="result-box">
                                <div class="result-label">M√©moire</div>
                                <div class="result-value" id="result-memory">-</div>
                                <div class="result-unit">KB</div>
                            </div>
                            <div class="result-box highlight-result">
                                <div class="result-label">P(faux positif)</div>
                                <div class="result-value" id="result-fp">-</div>
                                <div class="result-unit">%</div>
                            </div>
                        </div>
                        
                        <div class="interpretation">
                            <p><strong>üí° Interpr√©tation :</strong></p>
                            <p id="interpretation-text">Ajustez les param√®tres pour voir l'impact sur la probabilit√© de faux positif.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 4: Analyse M√©moire -->
        <div class="slide" id="slide4">
            <h1 class="slide-title">Analyse M√©moire et Vitesse</h1>
            
            <div class="slide4-new-layout">
                <!-- Ligne 1 : Explication + Tableau comparatif -->
                <div class="slide4-top">
                    <!-- Explication du gain m√©moire -->
                    <div class="memory-explanation">
                        <h3>üß† Pourquoi cette √©conomie de m√©moire ?</h3>
                        <div class="explanation-content">
                            <div class="explanation-text">
                                <p>Le <strong>BloomFilter</strong> ne stocke pas les √©l√©ments eux-m√™mes, mais seulement un <strong>tableau de bits</strong>.</p>
                                <p>Sa taille d√©pend du <strong>taux d'erreur choisi (p)</strong> :</p>
                                <p class="formula-inline">$m = \frac{-n \ln(p)}{(\ln 2)^2}$ bits</p>
                                <p class="key-insight">üí° Plus on tol√®re d'erreurs, moins on utilise de m√©moire !</p>
                            </div>
                            <div class="explanation-visual">
                                <div class="struct-box hashset-struct">
                                    <div class="struct-title">HashSet</div>
                                    <div class="struct-item">üîë "python" ‚Üí 50 bytes</div>
                                    <div class="struct-item">üîë "java" ‚Üí 50 bytes</div>
                                    <div class="struct-item">üîë "rust" ‚Üí 50 bytes</div>
                                    <div class="struct-total">‚âà 150 bytes pour 3 mots</div>
                                </div>
                                <div class="struct-box bloom-struct">
                                    <div class="struct-title">BloomFilter</div>
                                    <div class="struct-item">üéØ BitSet[64] = 8 bytes</div>
                                    <div class="struct-item">‚úÖ Contient les 3 mots</div>
                                    <div class="struct-total">‚âà 8 bytes total</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Tableau comparatif am√©lior√© -->
                    <div class="comparison-table-enhanced">
                        <h3>üìä Tableau comparatif complet</h3>
                        <table>
                            <thead>
                                <tr>
                                    <th>Structure</th>
                                    <th>M√©moire/√©l√©ment</th>
                                    <th>Faux positifs</th>
                                    <th>Suppression</th>
                                    <th>Complexit√©</th>
                                    <th>Vitesse</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="hashset-row">
                                    <td><strong>HashSet</strong></td>
                                    <td>50-100 bytes</td>
                                    <td>‚ùå Non</td>
                                    <td>‚úÖ Oui</td>
                                    <td>O(1) amorti</td>
                                    <td>0.1-1 ms</td>
                                </tr>
                                <tr class="bloom-row">
                                    <td><strong>BloomFilter</strong></td>
                                    <td>10-20 bits</td>
                                    <td>‚úÖ Oui (p)</td>
                                    <td>‚ùå Non</td>
                                    <td>O(k) constant</td>
                                    <td>0.02 ms ‚ö°</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Ligne 2 : Graphiques -->
                <div class="slide4-middle">
                    <!-- Graphique 1 : Impact du taux d'erreur -->
                    <div class="chart-container">
                        <h3>üìâ Impact du taux d'erreur (p) sur la m√©moire</h3>
                        <canvas id="memoryErrorChart"></canvas>
                        <p class="chart-caption">Plus p est petit, plus on a besoin de bits par √©l√©ment</p>
                    </div>
                    
                    <!-- Graphique 2 : Temps de recherche -->
                    <div class="chart-container">
                        <h3>‚ö° Temps de recherche selon le volume</h3>
                        <canvas id="speedComparisonChart"></canvas>
                        <p class="chart-caption">Le BloomFilter reste constant O(k) gr√¢ce au cache CPU</p>
                    </div>
                    
                    <!-- Section Performance -->
                    <div class="performance-box">
                        <h3>üöÄ Pourquoi si rapide ?</h3>
                        <div class="perf-reasons">
                            <div class="perf-item">
                                <span class="perf-icon">üíæ</span>
                                <div>
                                    <strong>Cache CPU</strong>
                                    <p>Le BitSet entier tient souvent en cache L2/L3</p>
                                </div>
                            </div>
                            <div class="perf-item">
                                <span class="perf-icon">üéØ</span>
                                <div>
                                    <strong>Acc√®s direct</strong>
                                    <p>k acc√®s m√©moire pr√©dictibles (pas de parcours)</p>
                                </div>
                            </div>
                            <div class="perf-item">
                                <span class="perf-icon">‚ö°</span>
                                <div>
                                    <strong>Operations binaires</strong>
                                    <p>Test de bits ultra-rapide en hardware</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Ligne 3 : Limites et Synth√®se -->
                <div class="slide4-bottom">
                    <!-- Limites -->
                    <div class="limits-box">
                        <h3>‚ö†Ô∏è Limites et remarques</h3>
                        <div class="limits-grid">
                            <div class="limit-item">
                                <span class="limit-icon">‚ùå</span>
                                <strong>Pas de suppression</strong>
                                <p>Impossible sans Counting Bloom Filter</p>
                            </div>
                            <div class="limit-item">
                                <span class="limit-icon">‚ö†Ô∏è</span>
                                <strong>Faux positifs</strong>
                                <p>Proportion contr√¥l√©e par p</p>
                            </div>
                            <div class="limit-item">
                                <span class="limit-icon">üìä</span>
                                <strong>Saturation</strong>
                                <p>Inefficace si >70% des bits √† 1</p>
                            </div>
                            <div class="limit-item">
                                <span class="limit-icon">üî¢</span>
                                <strong>Capacit√© fixe</strong>
                                <p>Redimensionnement co√ªteux</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Synth√®se finale -->
                    <div class="final-synthesis">
                        <div class="synth-item">
                            <span class="synth-icon">ÔøΩ</span>
                            <div class="synth-value">~40√ó</div>
                            <div class="synth-label">moins de m√©moire</div>
                        </div>
                        <div class="synth-item">
                            <span class="synth-icon">‚ö°</span>
                            <div class="synth-value">~50√ó</div>
                            <div class="synth-label">plus rapide</div>
                        </div>
                        <div class="synth-item">
                            <span class="synth-icon">üìä</span>
                            <div class="synth-value">O(k)</div>
                            <div class="synth-label">complexit√© constante</div>
                        </div>
                        <div class="synth-item">
                            <span class="synth-icon">üéØ</span>
                            <div class="synth-value">‚âà p</div>
                            <div class="synth-label">taux de faux positifs</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 5: D√©monstration Interactive (Mode Debug) -->
        <div class="slide" id="slide5">
            <h1 class="slide-title">üêõ D√©monstration Interactive</h1>
            
            <div class="debugger-layout">
                <!-- GAUCHE : Code complet de bloom.py -->
                <div class="source-code-panel">
                    <h3>üìÑ bloom.py (Code Source Complet)</h3>
                    <pre class="full-source-code" id="full-source-code"><code><span class="line" data-line="1">class BitSet:</span>
<span class="line" data-line="2">    def __init__(self, size: int):</span>
<span class="line" data-line="3">        if size <= 0:</span>
<span class="line" data-line="4">            raise ValueError("La taille doit √™tre > 0")</span>
<span class="line" data-line="5">        self.size = size</span>
<span class="line" data-line="6">        self.array = bytearray((size + 7) // 8)</span>
<span class="line" data-line="7"></span>
<span class="line" data-line="8">    def _check_index(self, index: int):</span>
<span class="line" data-line="9">        if not (0 <= index < self.size):</span>
<span class="line" data-line="10">            raise IndexError("Index hors limites")</span>
<span class="line" data-line="11"></span>
<span class="line" data-line="12">    def set(self, index: int):</span>
<span class="line" data-line="13">        """Met le bit √† 1"""</span>
<span class="line" data-line="14">        self._check_index(index)</span>
<span class="line" data-line="15">        byte_index = index // 8</span>
<span class="line" data-line="16">        mask = 1 << (index % 8)</span>
<span class="line" data-line="17">        self.array[byte_index] |= mask</span>
<span class="line" data-line="18"></span>
<span class="line" data-line="19">    def get(self, index: int) -> bool:</span>
<span class="line" data-line="20">        """Retourne True si le bit est √† 1"""</span>
<span class="line" data-line="21">        self._check_index(index)</span>
<span class="line" data-line="22">        byte_index = index // 8</span>
<span class="line" data-line="23">        mask = 1 << (index % 8)</span>
<span class="line" data-line="24">        return (self.array[byte_index] & mask) != 0</span>
<span class="line" data-line="25"></span>
<span class="line" data-line="26">    def clear_all(self):</span>
<span class="line" data-line="27">        """Remet tout √† 0"""</span>
<span class="line" data-line="28">        for i in range(len(self.array)):</span>
<span class="line" data-line="29">            self.array[i] = 0</span>
<span class="line" data-line="30">        </span>
<span class="line" data-line="31"></span>
<span class="line" data-line="33">   </span>
<span class="line" data-line="34">       </span>
<span class="line" data-line="35">        </span>
<span class="line" data-line="36">            </span>
<span class="line" data-line="37"></span>
<span class="line" data-line="38"></span>
<span class="line" data-line="39">import math, hashlib</span>
<span class="line" data-line="40"></span>
<span class="line" data-line="41">class BloomFilter:</span>
<span class="line" data-line="42">    def __init__(self, capacity: int, error_rate: float):</span>
<span class="line" data-line="43">        if capacity <= 0:</span>
<span class="line" data-line="44">            raise ValueError("Capacity doit √™tre > 0")</span>
<span class="line" data-line="45">        if not (0 < error_rate < 1):</span>
<span class="line" data-line="46">            raise ValueError("Error_rate doit √™tre entre 0 et 1")</span>
<span class="line" data-line="47"></span>
<span class="line" data-line="48">        self.capacity = capacity</span>
<span class="line" data-line="49">        self.error_rate = error_rate</span>
<span class="line" data-line="50"></span>
<span class="line" data-line="51">        # Taille en bits (m) et nombre de hash (k)</span>
<span class="line" data-line="52">        self.m = math.ceil(-capacity * math.log(error_rate) / (math.log(2) ** 2))</span>
<span class="line" data-line="53">        self.k = max(1, round(self.m / capacity * math.log(2)))</span>
<span class="line" data-line="54"></span>
<span class="line" data-line="55">        # BitSet sous-jacent</span>
<span class="line" data-line="56">        self.bitset = BitSet(self.m)</span>
<span class="line" data-line="57">        self.count = 0</span>
<span class="line" data-line="58"></span>
<span class="line" data-line="59">    def _hashes(self, item: str):</span>
<span class="line" data-line="60">        """Double hashing pour g√©n√©rer k indices"""</span>
<span class="line" data-line="61">        if isinstance(item, str):</span>
<span class="line" data-line="62">            data = item.encode("utf-8")</span>
<span class="line" data-line="63">        elif isinstance(item, bytes):</span>
<span class="line" data-line="64">            data = item</span>
<span class="line" data-line="65">        else:</span>
<span class="line" data-line="66">            data = str(item).encode("utf-8")</span>
<span class="line" data-line="67"></span>
<span class="line" data-line="68">        h1 = int.from_bytes(hashlib.sha256(data).digest(), 'big')</span>
<span class="line" data-line="69">        h2 = int.from_bytes(hashlib.md5(data).digest(), 'big')</span>
<span class="line" data-line="70"></span>
<span class="line" data-line="71">        for i in range(self.k):</span>
<span class="line" data-line="72">            yield (h1 + i * h2) % self.m</span>
<span class="line" data-line="73"></span>
<span class="line" data-line="74">    def add(self, item):</span>
<span class="line" data-line="75">        """Ajoute un √©l√©ment"""</span>
<span class="line" data-line="76">        for idx in self._hashes(item):</span>
<span class="line" data-line="77">            self.bitset.set(idx)</span>
<span class="line" data-line="78">        self.count += 1</span>
<span class="line" data-line="79"></span>
<span class="line" data-line="80">    def __contains__(self, item) -> bool:</span>
<span class="line" data-line="81">        """Teste si un √©l√©ment est peut-√™tre pr√©sent"""</span>
<span class="line" data-line="82">        return all(self.bitset.get(idx) for idx in self._hashes(item))</span>
<span class="line" data-line="83"></span>
<span class="line" data-line="84">    def __len__(self):</span>
<span class="line" data-line="85">        return self.count</span></code></pre>
                </div>
                
                <!-- DROITE : Ex√©cution √©tape par √©tape -->
                <div class="execution-panel">
                    <h3>‚ö° Ex√©cution Step-by-Step</h3>
                    
                    <!-- Contr√¥les de debug -->
                    <div class="debug-controls">
                        <button id="btn-debug-play" class="debug-btn" title="Lecture automatique">
                            ‚ñ∂Ô∏è Play
                        </button>
                        <button id="btn-debug-pause" class="debug-btn" title="Pause" disabled>
                            ‚è∏Ô∏è Pause
                        </button>
                        <button id="btn-debug-step" class="debug-btn" title="Ligne suivante">
                            ‚è≠Ô∏è Step
                        </button>
                        <button id="btn-debug-reset" class="debug-btn debug-btn-reset" title="R√©initialiser">
                            üîÑ Reset
                        </button>
                        <div class="debug-speed">
                            <label>Vitesse:</label>
                            <select id="debug-speed-select">
                                <option value="0.5">Tr√®s lent</option>
                                <option value="1" selected>Lent</option>
                                <option value="1.5">Normal</option>
                                <option value="2">Rapide</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Container pour les √©tapes (scrollable) -->
                    <div class="exec-steps-container">
                        <!-- √âtape 1 : Init -->
                        <div class="exec-step active" id="exec-step1">
                        <div class="exec-header">
                            <span class="exec-number">1Ô∏è‚É£</span>
                            <span>Initialisation</span>
                        </div>
                        <div class="exec-controls">
                            <input type="number" id="step1-n" value="100" min="10" max="1000" placeholder="n" style="width: 80px;">
                            <input type="number" id="step1-p" value="0.01" min="0.001" max="0.1" step="0.001" placeholder="p" style="width: 80px;">
                            <button id="btn-step1" class="btn-exec">‚ñ∂Ô∏è bloom = BloomFilter(n, p)</button>
                        </div>
                        <div class="exec-command" id="command-step1">
                            <code>>>> bloom = BloomFilter(100, 0.01)</code>
                        </div>
                        <div class="exec-output" id="output-step1">
                            <div class="output-hint">üëÜ Cliquez pour ex√©cuter</div>
                        </div>
                    </div>
                    
                    <!-- √âtape 2 : Add -->
                    <div class="exec-step disabled" id="exec-step2">
                        <div class="exec-header">
                            <span class="exec-number">2Ô∏è‚É£</span>
                            <span>Ajout d'√©l√©ments</span>
                        </div>
                        <div class="exec-controls">
                            <input type="number" id="step2-count" value="50" min="1" max="1000" placeholder="nb mots" style="width: 100px;">
                            <button id="btn-step2" class="btn-exec">‚ñ∂Ô∏è bloom.add(words)</button>
                        </div>
                        <div class="exec-command" id="command-step2">
                            <code>>>> for word in words[:50]: bloom.add(word)</code>
                        </div>
                        <div class="exec-output" id="output-step2"></div>
                    </div>
                    
                    <!-- √âtape 3 : Test -->
                    <div class="exec-step disabled" id="exec-step3">
                        <div class="exec-header">
                            <span class="exec-number">3Ô∏è‚É£</span>
                            <span>Test d'appartenance</span>
                        </div>
                        <div class="exec-controls">
                            <input type="text" id="step3-word" value="python" placeholder="mot" style="width: 120px;">
                            <button id="btn-step3" class="btn-exec">‚ñ∂Ô∏è word in bloom</button>
                            <button id="btn-show-words" class="btn-show-words" title="Afficher les mots ajout√©s">üìã Voir les mots ajout√©s</button>
                        </div>
                        <div class="exec-command" id="command-step3">
                            <code>>>> bloom.__contains__("python")</code>
                        </div>
                        
                        <!-- Liste des mots ajout√©s (cach√©e par d√©faut) -->
                        <div id="words-list-container" style="display: none; margin-top: 10px; padding: 10px; background: rgba(0,0,0,0.4); border-radius: 6px; max-height: 150px; overflow-y: auto;">
                            <div style="font-size: 0.85rem; font-weight: bold; margin-bottom: 8px; color: #43e97b;">
                                üìù Mots ajout√©s (<span id="words-count">0</span>) :
                            </div>
                            <div id="words-list" style="display: flex; flex-wrap: wrap; gap: 5px;"></div>
                        </div>
                        
                        <div class="exec-output" id="output-step3"></div>
                    </div>
                    </div><!-- Fin exec-steps-container -->
                </div>
            </div>
        </div>
        <!-- Slide 6: Conclusion -->
        <div class="slide" id="slide6">
            <h1 class="slide-title">‚ú® Conclusion</h1>
            
            <div class="conclusion-grid">
                <div class="conclusion-box highlight">
                    <h3>üéØ Points cl√©s</h3>
                    <ul>
                        <li>Structure probabiliste <strong>ultra-compacte</strong></li>
                        <li>Recherche en temps <strong>constant O(k)</strong></li>
                        <li>Aucun faux n√©gatif garanti</li>
                        <li>Faux positifs contr√¥lables via <strong>p</strong></li>
                    </ul>
                </div>
                
                <div class="conclusion-box">
                    <h3>‚úÖ Quand l'utiliser ?</h3>
                    <ul>
                        <li>Pr√©-filtrage avant requ√™te co√ªteuse</li>
                        <li>Contraintes m√©moire fortes</li>
                        <li>Volume de donn√©es massif</li>
                        <li>Faux positifs acceptables</li>
                    </ul>
                </div>
                
                <div class="conclusion-box">
                    <h3>‚ùå Quand √©viter ?</h3>
                    <ul>
                        <li>Besoin de suppression d'√©l√©ments</li>
                        <li>Aucun faux positif tol√©r√©</li>
                        <li>Petits ensembles de donn√©es</li>
                        <li>Besoin de compter pr√©cis√©ment</li>
                    </ul>
                </div>
                
                <div class="conclusion-box">
                    <h3>üöÄ Variantes avanc√©es</h3>
                    <ul>
                        <li><strong>Counting Bloom Filter</strong>: suppression possible</li>
                        <li><strong>Scalable Bloom Filter</strong>: capacit√© dynamique</li>
                        <li><strong>Multiple Bloom Filter</strong>: meilleure performance</li>
                    </ul>
                </div>
            </div>
            
            <div class="final-message">
                <h2>üå∏ Merci de votre attention !</h2>
                <p class="subtitle">Questions ?</p>
            </div>
            
            <div class="footer-info">
                <p>Pr√©sentation interactive - Filtre de Bloom</p>
                <p>Impl√©mentation: Python + Flask + JavaScript</p>
            </div>
        </div>
    </div>

    <!-- Navigation Controls -->
    <div class="nav-controls">
        <button id="btn-prev" class="nav-btn">‚¨ÖÔ∏è</button>
        <span id="slide-counter">1 / 6</span>
        <button id="btn-next" class="nav-btn">‚û°Ô∏è</button>
    </div>
    
    <!-- Keyboard hint -->
    <div class="keyboard-hint">
        Utilisez ‚Üê ‚Üí ou cliquez sur les boutons pour naviguer
    </div>

    <script src="{{ url_for('static', filename='js/slides.js') }}"></script>
    <script src="{{ url_for('static', filename='js/debugger-demo.js') }}"></script>
    <script src="{{ url_for('static', filename='js/charts.js') }}"></script>
</body>
</html>
